<!DOCTYPE html>
<html lang="en">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>Swicity - Visualizing Swift Systems as cities!</title>
		<script src="https://d3js.org/d3.v4.min.js"></script>
        <script src="js/three.js"></script>
        <script src="js/OrbitControls.js"></script>
	</head>
	<body>

        <script>

            var controls ;

            document.onkeydown = function(e) {
                switch (e.keyCode) {
                    case 37:
                        camera.position.x *= 1.1;
                        break;
                    case 38:
                        camera.position.y *= 0.9;
                        break;
                    case 39:
                        camera.position.x *= 0.9;
                        break;
                    case 40:
                        camera.position.y *= 1.1;
                        break;
                    case 189:
                        camera.position.z *= 1.1;
                        break;
                    case 187:
                        camera.position.z *= 0.9;
                        break;
                    default:
                        console.log(e.keyCode);
                }
            };

            function init(){

                setUp();

                renderData();

                camera.position.z = 5;
                camera.position.y = 5;
                camera.position.x = 1;

                scene.background = new THREE.Color(0xffffdd);

                var orbit = new THREE.OrbitControls( camera, renderer.domElement );
                render(renderer);

            }

            function setUp(){
                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera(150, window.innerWidth / window.innerHeight, 1, 1000);

                renderer = new THREE.WebGLRenderer();
                renderer.setSize( width, height);
                document.body.appendChild( renderer.domElement );
            }

            function render() {
                requestAnimationFrame(render);
                //cube.rotation.y += 0.01;
                renderer.render(scene, camera);
            }

            function renderData(){

                var scaleX = d3.scaleLinear()
                    .domain([0,dataset.length])
                    .range([-width/2, width]);

                for(var el in dataset){
                    var element = dataset[el];
                    var value = element.coordinates;
                    var geometry = new THREE.BoxGeometry( value[0], value[1], value[2]);
                    var material = new THREE.MeshBasicMaterial( { color: pickColor(element.key) } );
                    var newCube = new THREE.Mesh( geometry, material );
                    console.log(el);
                    console.log(scaleX(el));
                    newCube.position.x = 1 * el;
                    newCube.position.y = value[1]/2;
                    //newCube.applyMatrix(new THREE.Matrix4().makeTranslation((el*1.0), 0, 0) );
                    //newCube.faces.splice( 3, 1 );
                    scene.add(newCube);
                }

            }

            //Global parameters
            var height = 700;
            var width = 850;
            var scene;
            var camera;
            var renderer;
            var cube;

            var dataset = [
                { key: "Class", coordinates:[1.0,1.0,1.0]},
                { key: "Functions", coordinates:[1,2,1]}
            ];

            function pickColor(key) {
                if (key == "Class")
                    return "red";
                else (key == "Functions")
                    return "blue";
            }
            init();

        </script>

    </body>
</html>
